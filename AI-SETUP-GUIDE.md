# ‚ú® AI Setup Guide for Couple Chat App

This document walks you through enabling **all AI-powered features** in the Couple Chat App.  
Once complete you and your partner will receive relationship insights, conversation starters, emoji analysis, personalised date ideas and memory summaries ‚Äì all generated by Google‚Äôs **Gemini 2.5 Flash** model.

---

## 1  Prerequisites

| Requirement | Why it‚Äôs needed |
|-------------|-----------------|
| Google (GCP) account with billing enabled | Gemini access requires an active Cloud project with billing |
| Node.js backend running (`localhost:3001` by default) | Where calls to Gemini are made |
| Environment file `backend/.env` present | Stores private API key |

---

## 2  Get a Gemini API Key

1. Sign-in to Google Cloud Console ‚Üí **API Keys & Services**  
   Direct link: <https://makersuite.google.com/app/apikey>
2. Click **‚ÄúCreate API key‚Äù** ‚Üí copy the 40-character key that starts with `AIza‚Ä¶`.
3. Keep it safe ‚Äì it acts like a password to the LLM service.

> Tip: You can create multiple keys (dev, staging, prod) to monitor usage separately.

---

## 3  Enable the Gemini API

If this is your first time:

```text
Cloud Console ‚ñ∂ APIs & Services ‚ñ∂ Library ‚ñ∂ ‚ÄúGenerative Language API‚Äù ‚ñ∂ ENABLE
```

---

## 4  Configure the Backend

Open `backend/.env` and locate the AI section:

```
# AI Configuration
GEMINI_API_KEY=
GEMINI_MODEL=gemini-1.5-flash
```

1. Paste your key after `GEMINI_API_KEY=`  
2. (Optional) Update `GEMINI_MODEL` to another available model such as  
   `gemini-2.5-flash` or `gemini-1.0-pro` when released.
3. Save the file.

> **Security best-practice:** never commit `.env` to Git.  
> Use environment variables or secrets manager in production.

---

## 5  Restart the Backend

```bash
# from project root
cd backend
npm run dev        # or pm2 / docker compose up -d
```

Console should **not** show any ‚ÄúAPI key not valid‚Äù errors.

---

## 6  Verify AI Connectivity

Call the built-in health probe:

```bash
curl -H "Authorization: Bearer <your-jwt>" \
     http://localhost:3001/api/ai/<chatId>/relationship-insights
```

Expected JSON (abridged):

```json
{
  "success": true,
  "insights": {
    "healthScore": 8,
    ...
  }
}
```

If you receive:

```
{
  "success": false,
  "error": "Gemini API key is not configured..."
}
```

double-check the key and restart the server.

---

## 7  Where AI Appears in the App

| Feature | Location | What it does |
|---------|----------|--------------|
| **Relationship Health Score** | Analytics ‚Ä£ Overview card | 1‚Äì10 score plus patterns & suggestions |
| **AI Insights Tab** | Analytics ‚Ä£ ‚ÄúInsights‚Äù | Positive observations, growth areas, communication analysis |
| **Conversation Starters** | Chat Window ‚Ä£ üí° icon (coming soon) | 5 prompts based on recent topics |
| **Emoji Insights** | Analytics ‚Ä£ Words/Emoji | Explains what your favourite emojis say about you two |
| **Date Ideas** | Analytics ‚Ä£ Insights | Tailored outings based on chat-detected interests & location |
| **Memory Summaries** | Analytics ‚Ä£ Insights | Poetic recap for last week / month / year |

When the backend detects a missing or invalid key the UI will gracefully show **‚ÄúAI Insights Unavailable‚Äù** cards with setup instructions.

---

## 8  Rate Limits & Cost Control

* Gemini free tier ‚Üí ~60 requests/min & daily quota.  
* Use `GEMINI_MODEL=gemini-1.5-flash` for fastest, cheapest results.  
* Monitor usage: **Cloud Console ‚Üí APIs & Services ‚Üí Metrics**  
* You can implement per-user throttling by editing `backend/services/geminiService.js` and adding a simple in-memory or Redis rate-limit.

---

## 9  Troubleshooting

| Symptom | Likely Cause | Fix |
|---------|--------------|-----|
| 400 `API key not valid` | Key typo / wrong project | Re-copy key, ensure correct project is selected |
| 404 `Model not found` | Wrong `GEMINI_MODEL` value | Use `gemini-1.5-flash` or an enabled model |
| 429 rate-limit errors | Too many calls | Add caching or slow down requests |
| Front-end shows ‚ÄúAI insights unavailable‚Äù | Backend returned error | Check backend logs, verify key & restart |

---

## 10  Next Steps

1. Share the **Insights tab** screenshots with your partner üìäüíï  
2. Experiment with bigger models (`gemini-2.5-flash`) for deeper analysis.  
3. Extend AI features (poem generator, anniversary gift ideas) ‚Äì `backend/controllers/aiController.js` is fully modular.

Enjoy the magic of AI-enhanced love conversations!  
Feel free to open issues or contribute new features. üíñ
